<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<title>Recoil Macro Trainer (Educational)</title>
<meta name="viewport" content="width=device-width,initial-scale=1" />
<style>
  body { margin:0; background:#0f1720; color:#e6eef8; font-family:sans-serif; display:flex; }
  canvas { background:#16161b; margin:12px; border-radius:8px; }
  #panel { margin:12px; padding:12px; background:#1e293b; border-radius:8px; width:280px; }
  button { padding:8px 12px; margin-top:8px; display:block; }
</style>
</head>
<body>
<canvas id="cv" width="800" height="600"></canvas>
<div id="panel">
  <h2>Recoil Macro Trainer</h2>
  <p>Click inside canvas to fire. Hold <strong>LMB</strong>:</p>
  <ul>
    <li><strong>Macro Off</strong>: you control recoil with your mouse.</li>
    <li><strong>Macro On</strong>: script auto-compensates recoil with slight randomness.</li>
  </ul>
  <button id="toggle">Macro: OFF</button>
  <div id="status"></div>
</div>
<script>
const cv = document.getElementById('cv');
const ctx = cv.getContext('2d');
const W = cv.width, H = cv.height;
const center = {x: W/2, y: H/2};

let macroEnabled = false;
document.getElementById('toggle').onclick = () => {
  macroEnabled = !macroEnabled;
  document.getElementById('toggle').innerText = "Macro: " + (macroEnabled ? "ON" : "OFF");
};

let mouseDown = false;
let shots = [];
let macroShots = [];
let lastMouse = {...center};

cv.addEventListener('mousedown', e => {
  if (e.button===0) { mouseDown = true; runBurst(); }
});
window.addEventListener('mouseup', e => { if (e.button===0) mouseDown = false; });
cv.addEventListener('mousemove', e => {
  const r = cv.getBoundingClientRect();
  lastMouse = {x:e.clientX-r.left, y:e.clientY-r.top};
});

// Example recoil pattern (y goes up each shot)
const basePattern = [
  {x:0,y:5},{x:1,y:10},{x:1,y:15},
  {x:0,y:20},{x:-1,y:24},{x:0,y:28}
];

async function runBurst(){
  shots = [];
  macroShots = [];
  const burstLen = basePattern.length;
  for (let i=0;i<burstLen && mouseDown;i++){
    if (!macroEnabled) {
      // record player's mouse at shot time
      shots.push({...lastMouse});
    } else {
      // scripted macro: center + compensating move
      const ideal = basePattern[i];
      // add randomness
      const jitterX = (Math.random()*6-3); // ±3 px
      const jitterY = (Math.random()*6-3);
      macroShots.push({
        x:center.x - ideal.x + jitterX,
        y:center.y + ideal.y + jitterY
      });
    }
    draw();
    // wait ~100ms with jitter
    const jitter = (Math.random()*20-10); // ±10 ms
    await new Promise(r=>setTimeout(r,100+jitter));
  }
}

function draw(){
  ctx.clearRect(0,0,W,H);
  ctx.fillStyle = '#0f1724';
  ctx.fillRect(0,0,W,H);

  // draw crosshair
  ctx.strokeStyle = '#cbd5e1';
  ctx.beginPath();
  ctx.moveTo(center.x-10, center.y); ctx.lineTo(center.x+10, center.y);
  ctx.moveTo(center.x, center.y-10); ctx.lineTo(center.x, center.y+10);
  ctx.stroke();

  // player shots
  ctx.fillStyle = '#7ee787';
  for (const s of shots){
    ctx.beginPath(); ctx.arc(s.x,s.y,5,0,Math.PI*2); ctx.fill();
  }
  // macro shots
  ctx.fillStyle = '#ff7b7b';
  for (const s of macroShots){
    ctx.beginPath(); ctx.arc(s.x,s.y,5,0,Math.PI*2); ctx.fill();
  }
}
draw();
</script>
</body>
</html>
